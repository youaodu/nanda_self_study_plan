**多道程序设计**



多道程序设计环境特点：

​		1.独立性

​				在多道环境下执行的每道程序都是逻辑上独立的，且执行速度与其他程序无关，执行的起止时间也是独立的。

​		2.随机性

​				程序和数据的输入与执行开始时间都是随机的

​		3.资源共享性

​				在多道程序设计下的程序，都是共享系统资源的，如（CPU，内存，硬盘等...）



多道程序设计环境缺陷

​		1.可能延长程序的执行时间

​		2.系统效率的提高有一定限度

-------

**进程**

​		定义：

​				进程是具有一定独立功能的程序在某个数据集合上的一次运行活动，是系统进行分配和调度的一个独立单位。



​		分类：

​			1.系统进程（操作系统的程序在运行）

​			2.用户进程（用户系统的程序在运行）

​		

​		特征：(重点)

​				1.并发性	2.动态性	3.独立性	4.交往性	5.异步性	6.结构性

​		

​		进程状态

​				三状态模型

​						1.运行状态

​						2.就绪状态

​						3.等待状态（阻塞状态）

​				五状态模型

​						1.运行状态

​						2.就绪状态

​						3.等待状态（阻塞状态）

​						4.创建状态

​						5.结束状态

​				七状态模型

​						1.运行状态

​						2.就绪状态

​						3.阻塞/挂起状态

​						4.创建状态

​						5.结束状态

​						6.就绪/挂起状态

​						7.阻塞状态						

​			状态转换过程

​				1.就绪 -> 运行

​				2.运行 -> 就绪（资源被抢占，进入就绪状态）

​				3.运行 -> 等待

​				4.等待 -> 就绪	



​		进程和程序的关联：

​				程序是构成进程组成部分之一，一个进程的运行目标是执行它所对应的程序。

​		进程和程序的区别：

​				1.状态不同。程序是静态的（放在磁盘上），进程是动态的

​				2.两者是多对多关系。

​		进程组成结构

​				进程 = 程序 + 数据 + 进程控制块（PCB）



-----

**进程控制块**

​		作用：

​				描述进程的基本情况以及进程的运行变化过程。

​				PCB是进程存在的唯一标志，当系统创建一个进程是，必须为进程设置一个PCB，在利用PCB对进程进行控制和管理。撤销进程时，系统收回PCB，进程随之消亡。

​		PCB当中的内容

​				1.调度信息

​						包括进程名、进程号、地址空间信息、优先级、当前状态、资源清单、家族关系、消息队列指针、进程队列指针和当前打开文件等。

​				2.现场信息

​						刻画了运行情况，主要是CPU寄存器的信息，如程序状态字、时钟、界地址寄存器等。当程序中断是，需要保存现场信息。



​		进程队列

​				1.就绪队列（1或多个）

​				2.等待队列（多个，因为等待原因不一致，一个原因一个队列）

​				3.运行队列（多个，一个CPU可能有一个）



----

**进程控制**

​		名词说明

​				进程控制：对进程整个生命周期中各种状态之间的装换进行的控制。有原语实现。

​				原语：就是由若干条指令组成的，用于完成一定功能的一个过程，一个不可分割的进本单位，即原语在执行过程中不允许被中断。原子操作在系统态下执行，常驻内存。

​		进程控制原语：

​				1.创建原语：

​						一个进程可以使用创建原语创建一个新的进程，前者称为父进程，后者称为子进程，子进程又可以创建新进程，形成进程家族。

​						主要任务：建立进程控制块PCB

​						执行过程：先申请一块空闲PCB，然后将有关信息填入PCB，置进程状态为就绪状态，插入就绪队列。

​				2.撤销原语

​						当一个进程完成任务后，应当撤销它，以便及时释放它所占用的资源。

​						主要任务：撤销进程控制块PCB

​						执行过程：找到要被撤销进程的PCB，将它从所在队列中删除，撤销属于该进程的一切子进程所占的全部资源，并消去被撤销进程的PCB。

​				3.阻塞原语

​						若某个进程的执行过程中需要I/O操作，则该进程调用阻塞原语将其从运行状态转换为阻塞状态。

​						执行过程：产生中断，把处理器的当前状态保存在PCB的现场信息中，当前进程置为等待态，插入等待队列。

​				4.唤醒原语

​						一个进程因为等待某事件的发生而处于等待状态，当该事件发生后，就用唤醒原语将其转换为就绪状态。

​						执行过程：在等待队列中找到该进程，讲进程的当前状态置为就绪状态，然后将它从等待队列中撤出并插入到就绪队列中排队，等待调度执行。

-----

**线程**

---

**进程调度**

​		主要功能：

​				1.记录系统中所有进程的执行状态

​				2.根据一定的调度算法，从就绪队列中选出一个进程，准备处理器分配给它；

​				3.分配处理器

​		进程调度的时机

​				1.正在执行的进程运行完毕

​				2.正在执行的进程由于某种错误而终止运行了

​				3.时间片完

​				4.正在执行的进程调用阻塞原语将自己阻塞起来

​				5.创建了新的进程

​				6.正在执行的进程调用了唤醒原语操作激活了等待资源的进程

​		

​		处理器的调度方式：

​				非抢占式

​						一旦把处理器分配给某个进程后，就一直让它运行下去，决不会因为时钟中断，或任何其他原因，去抢占改正在运行进程的处理机，直至该进程完成，或发生某事件而被阻塞（自愿放弃），才把处理机分配给其他线程。

​				可抢占式

​						允许调度程序根据某种原则，去暂停某个正在执行的进程，将已分配给该进程的处理机，重新分配给另一进程。

​						抢占方式能满足实时任务的需求。但抢占方式比较复杂，所需付出系统开销也比较大。



​		调度算法设计原则

​				1.进程行为

​						I\O密集型和计算密集型

​				2.系统分类

​						批处理、交互式、实时系统

​				3.调度算法的设计目标

​						共同目标：资源利用率高、公平、平衡、强制执行策略。

​						批处理目标：平均周转时间短、系统吞吐量高、处理机利用率好。

​						分时系统目标：响应时间快、均衡性。

​						实时系统目标：截止时间的保证、可预测性。



​		进程调度算法

​				1.***先进先服务算法（重点）***

​				1.***先来先服务（重点）***

​						算法思想：总是把处理机分配给最先进入就绪队列的进程，一旦进程分得处理机，便执行下去，直到该进程完成或阻塞时，才释放处理机。

​						优点：实现简单

​						缺点：没有考虑进程优先级 

​				2.***最短进程优先算法（重点）***

​						算法思想：该算法从就绪队列中选出“下一个CPU执行期”最短的进程，为之分配处理机

​						优点：所有进程都同时可运行时算法最优。

​				3.最短剩余时间优先算法

​						算法思想：总是选择剩余时间最短的那个进程运行。当一个新的进程到达时，其整个时间同当前进程的剩余时间做比较，如果新进程时间更少，则当前进程被挂起，运行新进程。

​				4.***最高响应比优先算法（重点）***

​						算法思想：总是优先调度响应比最大的进程

​						性能：先来先服务和最短进程优先算法的折中

​						响应比计算方法：Rp = （等待时间 + 预计运行时间） / 预计运行时间 = 1 + 等待时间 / 预计运行时间

​				5.轮转算法

​					算法思想：将处理器的处理时间划分成一个个时间片，就绪队列中的各个进程轮流运行一个时间片，当时间片结束时，就强迫运行进程让出处理器，该进程进入就绪队列，等待下一次调度。

​					影响时间片设置的因素：

​							1.系统响应时间

​							2.就绪进程的数目

​							3.计算机的处理能力

​				6.最高优先级算法

​						算法思想：为每个进程设立一个优先级，每次将处理器分配给具有最高优先级的就绪进程。

​						有点：可以保证紧迫性进程优先运行

​				7.多级反馈队列算法

​						介绍：结合了先进先出、时间片轮转、可抢占式最高优先级调度算法。

​						算法思想要点：

​								1.被调度队列的设置（多个队列）

​								2.在同一个队列内的调度原则

​								3.在不同调度队列之间的调度原则

​								4.进程优先级的调整原则

```java
进程调度算法选择考虑原则
  1.处理器利用率
  2.吞吐量
  3.等待时间
  4.响应时间
```



